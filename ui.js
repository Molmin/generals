"use strict";(()=>{var Vo=Object.create;var Ut=Object.defineProperty;var Ko=Object.getOwnPropertyDescriptor;var Yo=Object.getOwnPropertyNames;var Jo=Object.getPrototypeOf,Xo=Object.prototype.hasOwnProperty;var h=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Hr=(t,e)=>{for(var r in e)Ut(t,r,{get:e[r],enumerable:!0})},jo=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Yo(e))!Xo.call(t,i)&&i!==r&&Ut(t,i,{get:()=>e[i],enumerable:!(n=Ko(e,i))||n.enumerable});return t};var Ie=(t,e,r)=>(r=t!=null?Vo(Jo(t)):{},jo(e||!t||!t.__esModule?Ut(r,"default",{value:t,enumerable:!0}):r,t));var Wr=h((zc,Mt)=>{typeof Mt<"u"&&(Mt.exports=N);function N(t){if(t)return Qo(t)}function Qo(t){for(var e in N.prototype)t[e]=N.prototype[e];return t}N.prototype.on=N.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};N.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};N.prototype.off=N.prototype.removeListener=N.prototype.removeAllListeners=N.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};N.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};N.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};N.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var Jr=h((Vc,Yr)=>{Yr.exports=Ne;Ne.default=Ne;Ne.stable=Vr;Ne.stableStringify=Vr;var nt="[...]",Gr="[Circular]",ne=[],re=[];function zr(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Ne(t,e,r,n){typeof n>"u"&&(n=zr()),Ht(t,"",0,[],void 0,0,n);var i;try{re.length===0?i=JSON.stringify(t,e,r):i=JSON.stringify(t,Kr(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;ne.length!==0;){var o=ne.pop();o.length===4?Object.defineProperty(o[0],o[1],o[3]):o[0][o[1]]=o[2]}}return i}function de(t,e,r,n){var i=Object.getOwnPropertyDescriptor(n,r);i.get!==void 0?i.configurable?(Object.defineProperty(n,r,{value:t}),ne.push([n,r,e,i])):re.push([e,r,t]):(n[r]=t,ne.push([n,r,e]))}function Ht(t,e,r,n,i,o,s){o+=1;var a;if(typeof t=="object"&&t!==null){for(a=0;a<n.length;a++)if(n[a]===t){de(Gr,t,e,i);return}if(typeof s.depthLimit<"u"&&o>s.depthLimit){de(nt,t,e,i);return}if(typeof s.edgesLimit<"u"&&r+1>s.edgesLimit){de(nt,t,e,i);return}if(n.push(t),Array.isArray(t))for(a=0;a<t.length;a++)Ht(t[a],a,a,n,t,o,s);else{var c=Object.keys(t);for(a=0;a<c.length;a++){var l=c[a];Ht(t[l],l,a,n,t,o,s)}}n.pop()}}function Zo(t,e){return t<e?-1:t>e?1:0}function Vr(t,e,r,n){typeof n>"u"&&(n=zr());var i=Wt(t,"",0,[],void 0,0,n)||t,o;try{re.length===0?o=JSON.stringify(i,e,r):o=JSON.stringify(i,Kr(e),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;ne.length!==0;){var s=ne.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return o}function Wt(t,e,r,n,i,o,s){o+=1;var a;if(typeof t=="object"&&t!==null){for(a=0;a<n.length;a++)if(n[a]===t){de(Gr,t,e,i);return}try{if(typeof t.toJSON=="function")return}catch{return}if(typeof s.depthLimit<"u"&&o>s.depthLimit){de(nt,t,e,i);return}if(typeof s.edgesLimit<"u"&&r+1>s.edgesLimit){de(nt,t,e,i);return}if(n.push(t),Array.isArray(t))for(a=0;a<t.length;a++)Wt(t[a],a,a,n,t,o,s);else{var c={},l=Object.keys(t).sort(Zo);for(a=0;a<l.length;a++){var f=l[a];Wt(t[f],f,a,n,t,o,s),c[f]=t[f]}if(typeof i<"u")ne.push([i,e,t]),i[e]=c;else return c}n.pop()}}function Kr(t){return t=typeof t<"u"?t:function(e,r){return r},function(e,r){if(re.length>0)for(var n=0;n<re.length;n++){var i=re[n];if(i[1]===e&&i[0]===r){r=i[2],re.splice(n,1);break}}return t.call(this,e,r)}}});var jr=h((Kc,Xr)=>{"use strict";Xr.exports=Error});var Zr=h((Yc,Qr)=>{"use strict";Qr.exports=EvalError});var tn=h((Jc,en)=>{"use strict";en.exports=RangeError});var nn=h((Xc,rn)=>{"use strict";rn.exports=ReferenceError});var Gt=h((jc,on)=>{"use strict";on.exports=SyntaxError});var ye=h((Qc,sn)=>{"use strict";sn.exports=TypeError});var cn=h((Zc,an)=>{"use strict";an.exports=URIError});var un=h((el,ln)=>{"use strict";ln.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,r);if(s.value!==i||s.enumerable!==!0)return!1}return!0}});var hn=h((tl,pn)=>{"use strict";var fn=typeof Symbol<"u"&&Symbol,es=un();pn.exports=function(){return typeof fn!="function"||typeof Symbol!="function"||typeof fn("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:es()}});var yn=h((rl,dn)=>{"use strict";var zt={__proto__:null,foo:{}},ts=Object;dn.exports=function(){return{__proto__:zt}.foo===zt.foo&&!(zt instanceof ts)}});var wn=h((nl,gn)=>{"use strict";var rs="Function.prototype.bind called on incompatible ",ns=Object.prototype.toString,is=Math.max,os="[object Function]",mn=function(e,r){for(var n=[],i=0;i<e.length;i+=1)n[i]=e[i];for(var o=0;o<r.length;o+=1)n[o+e.length]=r[o];return n},ss=function(e,r){for(var n=[],i=r||0,o=0;i<e.length;i+=1,o+=1)n[o]=e[i];return n},as=function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=e);return r};gn.exports=function(e){var r=this;if(typeof r!="function"||ns.apply(r)!==os)throw new TypeError(rs+r);for(var n=ss(arguments,1),i,o=function(){if(this instanceof i){var f=r.apply(this,mn(n,arguments));return Object(f)===f?f:this}return r.apply(e,mn(n,arguments))},s=is(0,r.length-n.length),a=[],c=0;c<s;c++)a[c]="$"+c;if(i=Function("binder","return function ("+as(a,",")+"){ return binder.apply(this,arguments); }")(o),r.prototype){var l=function(){};l.prototype=r.prototype,i.prototype=new l,l.prototype=null}return i}});var it=h((il,bn)=>{"use strict";var cs=wn();bn.exports=Function.prototype.bind||cs});var Sn=h((ol,vn)=>{"use strict";var ls=Function.prototype.call,us=Object.prototype.hasOwnProperty,fs=it();vn.exports=fs.call(ls,us)});var se=h((sl,Tn)=>{"use strict";var d,ps=jr(),hs=Zr(),ds=tn(),ys=nn(),be=Gt(),we=ye(),ms=cn(),xn=Function,Vt=function(t){try{return xn('"use strict"; return ('+t+").constructor;")()}catch{}},ie=Object.getOwnPropertyDescriptor;if(ie)try{ie({},"")}catch{ie=null}var Kt=function(){throw new we},gs=ie?function(){try{return arguments.callee,Kt}catch{try{return ie(arguments,"callee").get}catch{return Kt}}}():Kt,me=hn()(),ws=yn()(),T=Object.getPrototypeOf||(ws?function(t){return t.__proto__}:null),ge={},bs=typeof Uint8Array>"u"||!T?d:T(Uint8Array),oe={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?d:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?d:ArrayBuffer,"%ArrayIteratorPrototype%":me&&T?T([][Symbol.iterator]()):d,"%AsyncFromSyncIteratorPrototype%":d,"%AsyncFunction%":ge,"%AsyncGenerator%":ge,"%AsyncGeneratorFunction%":ge,"%AsyncIteratorPrototype%":ge,"%Atomics%":typeof Atomics>"u"?d:Atomics,"%BigInt%":typeof BigInt>"u"?d:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?d:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?d:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?d:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":ps,"%eval%":eval,"%EvalError%":hs,"%Float32Array%":typeof Float32Array>"u"?d:Float32Array,"%Float64Array%":typeof Float64Array>"u"?d:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?d:FinalizationRegistry,"%Function%":xn,"%GeneratorFunction%":ge,"%Int8Array%":typeof Int8Array>"u"?d:Int8Array,"%Int16Array%":typeof Int16Array>"u"?d:Int16Array,"%Int32Array%":typeof Int32Array>"u"?d:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":me&&T?T(T([][Symbol.iterator]())):d,"%JSON%":typeof JSON=="object"?JSON:d,"%Map%":typeof Map>"u"?d:Map,"%MapIteratorPrototype%":typeof Map>"u"||!me||!T?d:T(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?d:Promise,"%Proxy%":typeof Proxy>"u"?d:Proxy,"%RangeError%":ds,"%ReferenceError%":ys,"%Reflect%":typeof Reflect>"u"?d:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?d:Set,"%SetIteratorPrototype%":typeof Set>"u"||!me||!T?d:T(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?d:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":me&&T?T(""[Symbol.iterator]()):d,"%Symbol%":me?Symbol:d,"%SyntaxError%":be,"%ThrowTypeError%":gs,"%TypedArray%":bs,"%TypeError%":we,"%Uint8Array%":typeof Uint8Array>"u"?d:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?d:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?d:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?d:Uint32Array,"%URIError%":ms,"%WeakMap%":typeof WeakMap>"u"?d:WeakMap,"%WeakRef%":typeof WeakRef>"u"?d:WeakRef,"%WeakSet%":typeof WeakSet>"u"?d:WeakSet};if(T)try{null.error}catch(t){En=T(T(t)),oe["%Error.prototype%"]=En}var En,vs=function t(e){var r;if(e==="%AsyncFunction%")r=Vt("async function () {}");else if(e==="%GeneratorFunction%")r=Vt("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Vt("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&T&&(r=T(i.prototype))}return oe[e]=r,r},_n={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},De=it(),ot=Sn(),Ss=De.call(Function.call,Array.prototype.concat),Es=De.call(Function.apply,Array.prototype.splice),An=De.call(Function.call,String.prototype.replace),st=De.call(Function.call,String.prototype.slice),_s=De.call(Function.call,RegExp.prototype.exec),As=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,xs=/\\(\\)?/g,Ts=function(e){var r=st(e,0,1),n=st(e,-1);if(r==="%"&&n!=="%")throw new be("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new be("invalid intrinsic syntax, expected opening `%`");var i=[];return An(e,As,function(o,s,a,c){i[i.length]=a?An(c,xs,"$1"):s||o}),i},Os=function(e,r){var n=e,i;if(ot(_n,n)&&(i=_n[n],n="%"+i[0]+"%"),ot(oe,n)){var o=oe[n];if(o===ge&&(o=vs(n)),typeof o>"u"&&!r)throw new we("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:o}}throw new be("intrinsic "+e+" does not exist!")};Tn.exports=function(e,r){if(typeof e!="string"||e.length===0)throw new we("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new we('"allowMissing" argument must be a boolean');if(_s(/^%?[^%]*%?$/,e)===null)throw new be("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Ts(e),i=n.length>0?n[0]:"",o=Os("%"+i+"%",r),s=o.name,a=o.value,c=!1,l=o.alias;l&&(i=l[0],Es(n,Ss([0,1],l)));for(var f=1,p=!0;f<n.length;f+=1){var u=n[f],m=st(u,0,1),v=st(u,-1);if((m==='"'||m==="'"||m==="`"||v==='"'||v==="'"||v==="`")&&m!==v)throw new be("property names with quotes must have matching quotes");if((u==="constructor"||!p)&&(c=!0),i+="."+u,s="%"+i+"%",ot(oe,s))a=oe[s];else if(a!=null){if(!(u in a)){if(!r)throw new we("base intrinsic for "+e+" exists, but the property is not available.");return}if(ie&&f+1>=n.length){var x=ie(a,u);p=!!x,p&&"get"in x&&!("originalValue"in x.get)?a=x.get:a=a[u]}else p=ot(a,u),a=a[u];p&&!c&&(oe[s]=a)}}return a}});var ct=h((al,On)=>{"use strict";var ks=se(),at=ks("%Object.defineProperty%",!0)||!1;if(at)try{at({},"a",{value:1})}catch{at=!1}On.exports=at});var Yt=h((cl,kn)=>{"use strict";var Rs=se(),lt=Rs("%Object.getOwnPropertyDescriptor%",!0);if(lt)try{lt([],"length")}catch{lt=null}kn.exports=lt});var $n=h((ll,Pn)=>{"use strict";var Rn=ct(),Cs=Gt(),ve=ye(),Cn=Yt();Pn.exports=function(e,r,n){if(!e||typeof e!="object"&&typeof e!="function")throw new ve("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new ve("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new ve("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new ve("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new ve("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new ve("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,s=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,c=!!Cn&&Cn(e,r);if(Rn)Rn(e,r,{configurable:s===null&&c?c.configurable:!s,enumerable:i===null&&c?c.enumerable:!i,value:n,writable:o===null&&c?c.writable:!o});else if(a||!i&&!o&&!s)e[r]=n;else throw new Cs("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var Dn=h((ul,Nn)=>{"use strict";var Jt=ct(),In=function(){return!!Jt};In.hasArrayLengthDefineBug=function(){if(!Jt)return null;try{return Jt([],"length",{value:1}).length!==1}catch{return!0}};Nn.exports=In});var Un=h((fl,Fn)=>{"use strict";var Ps=se(),Ln=$n(),$s=Dn()(),Bn=Yt(),qn=ye(),Is=Ps("%Math.floor%");Fn.exports=function(e,r){if(typeof e!="function")throw new qn("`fn` is not a function");if(typeof r!="number"||r<0||r>4294967295||Is(r)!==r)throw new qn("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],i=!0,o=!0;if("length"in e&&Bn){var s=Bn(e,"length");s&&!s.configurable&&(i=!1),s&&!s.writable&&(o=!1)}return(i||o||!n)&&($s?Ln(e,"length",r,!0,!0):Ln(e,"length",r)),e}});var Vn=h((pl,ut)=>{"use strict";var Xt=it(),ft=se(),Ns=Un(),Ds=ye(),Wn=ft("%Function.prototype.apply%"),Gn=ft("%Function.prototype.call%"),zn=ft("%Reflect.apply%",!0)||Xt.call(Gn,Wn),Mn=ct(),Ls=ft("%Math.max%");ut.exports=function(e){if(typeof e!="function")throw new Ds("a function is required");var r=zn(Xt,Gn,arguments);return Ns(r,1+Ls(0,e.length-(arguments.length-1)),!0)};var Hn=function(){return zn(Xt,Wn,arguments)};Mn?Mn(ut.exports,"apply",{value:Hn}):ut.exports.apply=Hn});var Xn=h((hl,Jn)=>{"use strict";var Kn=se(),Yn=Vn(),Bs=Yn(Kn("String.prototype.indexOf"));Jn.exports=function(e,r){var n=Kn(e,!!r);return typeof n=="function"&&Bs(e,".prototype.")>-1?Yn(n):n}});var jn=h(()=>{});var gi=h((ml,mi)=>{var sr=typeof Map=="function"&&Map.prototype,jt=Object.getOwnPropertyDescriptor&&sr?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ht=sr&&jt&&typeof jt.get=="function"?jt.get:null,Qn=sr&&Map.prototype.forEach,ar=typeof Set=="function"&&Set.prototype,Qt=Object.getOwnPropertyDescriptor&&ar?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,dt=ar&&Qt&&typeof Qt.get=="function"?Qt.get:null,Zn=ar&&Set.prototype.forEach,qs=typeof WeakMap=="function"&&WeakMap.prototype,Be=qs?WeakMap.prototype.has:null,Fs=typeof WeakSet=="function"&&WeakSet.prototype,qe=Fs?WeakSet.prototype.has:null,Us=typeof WeakRef=="function"&&WeakRef.prototype,ei=Us?WeakRef.prototype.deref:null,Ms=Boolean.prototype.valueOf,Hs=Object.prototype.toString,Ws=Function.prototype.toString,Gs=String.prototype.match,cr=String.prototype.slice,j=String.prototype.replace,zs=String.prototype.toUpperCase,ti=String.prototype.toLowerCase,ui=RegExp.prototype.test,ri=Array.prototype.concat,q=Array.prototype.join,Vs=Array.prototype.slice,ni=Math.floor,tr=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Zt=Object.getOwnPropertySymbols,rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Se=typeof Symbol=="function"&&typeof Symbol.iterator=="object",k=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Se||!0)?Symbol.toStringTag:null,fi=Object.prototype.propertyIsEnumerable,ii=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function oi(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||ui.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-ni(-t):ni(t);if(n!==t){var i=String(n),o=cr.call(e,i.length+1);return j.call(i,r,"$&_")+"."+j.call(j.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return j.call(e,r,"$&_")}var nr=jn(),si=nr.custom,ai=hi(si)?si:null;mi.exports=function t(e,r,n,i){var o=r||{};if(X(o,"quoteStyle")&&o.quoteStyle!=="single"&&o.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(X(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=X(o,"customInspect")?o.customInspect:!0;if(typeof s!="boolean"&&s!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(X(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(X(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=o.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return yi(e,o);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return a?oi(e,c):c}if(typeof e=="bigint"){var l=String(e)+"n";return a?oi(e,l):l}var f=typeof o.depth>"u"?5:o.depth;if(typeof n>"u"&&(n=0),n>=f&&f>0&&typeof e=="object")return ir(e)?"[Array]":"[Object]";var p=ua(o,n);if(typeof i>"u")i=[];else if(di(i,e)>=0)return"[Circular]";function u(L,Y,J){if(Y&&(i=Vs.call(i),i.push(Y)),J){var $e={depth:o.depth};return X(o,"quoteStyle")&&($e.quoteStyle=o.quoteStyle),t(L,$e,n+1,i)}return t(L,o,n+1,i)}if(typeof e=="function"&&!ci(e)){var m=ta(e),v=pt(e,u);return"[Function"+(m?": "+m:" (anonymous)")+"]"+(v.length>0?" { "+q.call(v,", ")+" }":"")}if(hi(e)){var x=Se?j.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):rr.call(e);return typeof e=="object"&&!Se?Le(x):x}if(aa(e)){for(var P="<"+ti.call(String(e.nodeName)),I=e.attributes||[],z=0;z<I.length;z++)P+=" "+I[z].name+"="+pi(Ks(I[z].value),"double",o);return P+=">",e.childNodes&&e.childNodes.length&&(P+="..."),P+="</"+ti.call(String(e.nodeName))+">",P}if(ir(e)){if(e.length===0)return"[]";var g=pt(e,u);return p&&!la(g)?"["+or(g,p)+"]":"[ "+q.call(g,", ")+" ]"}if(Js(e)){var V=pt(e,u);return!("cause"in Error.prototype)&&"cause"in e&&!fi.call(e,"cause")?"{ ["+String(e)+"] "+q.call(ri.call("[cause]: "+u(e.cause),V),", ")+" }":V.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+q.call(V,", ")+" }"}if(typeof e=="object"&&s){if(ai&&typeof e[ai]=="function"&&nr)return nr(e,{depth:f-n});if(s!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(ra(e)){var ee=[];return Qn&&Qn.call(e,function(L,Y){ee.push(u(Y,e,!0)+" => "+u(L,e))}),li("Map",ht.call(e),ee,p)}if(oa(e)){var Pe=[];return Zn&&Zn.call(e,function(L){Pe.push(u(L,e))}),li("Set",dt.call(e),Pe,p)}if(na(e))return er("WeakMap");if(sa(e))return er("WeakSet");if(ia(e))return er("WeakRef");if(js(e))return Le(u(Number(e)));if(Zs(e))return Le(u(tr.call(e)));if(Qs(e))return Le(Ms.call(e));if(Xs(e))return Le(u(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===global)return"{ [object globalThis] }";if(!Ys(e)&&!ci(e)){var pe=pt(e,u),tt=ii?ii(e)===Object.prototype:e instanceof Object||e.constructor===Object,te=e instanceof Object?"":"null prototype",K=!tt&&k&&Object(e)===e&&k in e?cr.call(Q(e),8,-1):te?"Object":"",rt=tt||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",he=rt+(K||te?"["+q.call(ri.call([],K||[],te||[]),": ")+"] ":"");return pe.length===0?he+"{}":p?he+"{"+or(pe,p)+"}":he+"{ "+q.call(pe,", ")+" }"}return String(e)};function pi(t,e,r){var n=(r.quoteStyle||e)==="double"?'"':"'";return n+t+n}function Ks(t){return j.call(String(t),/"/g,"&quot;")}function ir(t){return Q(t)==="[object Array]"&&(!k||!(typeof t=="object"&&k in t))}function Ys(t){return Q(t)==="[object Date]"&&(!k||!(typeof t=="object"&&k in t))}function ci(t){return Q(t)==="[object RegExp]"&&(!k||!(typeof t=="object"&&k in t))}function Js(t){return Q(t)==="[object Error]"&&(!k||!(typeof t=="object"&&k in t))}function Xs(t){return Q(t)==="[object String]"&&(!k||!(typeof t=="object"&&k in t))}function js(t){return Q(t)==="[object Number]"&&(!k||!(typeof t=="object"&&k in t))}function Qs(t){return Q(t)==="[object Boolean]"&&(!k||!(typeof t=="object"&&k in t))}function hi(t){if(Se)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!rr)return!1;try{return rr.call(t),!0}catch{}return!1}function Zs(t){if(!t||typeof t!="object"||!tr)return!1;try{return tr.call(t),!0}catch{}return!1}var ea=Object.prototype.hasOwnProperty||function(t){return t in this};function X(t,e){return ea.call(t,e)}function Q(t){return Hs.call(t)}function ta(t){if(t.name)return t.name;var e=Gs.call(Ws.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function di(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function ra(t){if(!ht||!t||typeof t!="object")return!1;try{ht.call(t);try{dt.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function na(t){if(!Be||!t||typeof t!="object")return!1;try{Be.call(t,Be);try{qe.call(t,qe)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function ia(t){if(!ei||!t||typeof t!="object")return!1;try{return ei.call(t),!0}catch{}return!1}function oa(t){if(!dt||!t||typeof t!="object")return!1;try{dt.call(t);try{ht.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function sa(t){if(!qe||!t||typeof t!="object")return!1;try{qe.call(t,qe);try{Be.call(t,Be)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function aa(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function yi(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return yi(cr.call(t,0,e.maxStringLength),e)+n}var i=j.call(j.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,ca);return pi(i,"single",e)}function ca(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+zs.call(e.toString(16))}function Le(t){return"Object("+t+")"}function er(t){return t+" { ? }"}function li(t,e,r,n){var i=n?or(r,n):q.call(r,", ");return t+" ("+e+") {"+i+"}"}function la(t){for(var e=0;e<t.length;e++)if(di(t[e],`
`)>=0)return!1;return!0}function ua(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=q.call(Array(t.indent+1)," ");else return null;return{base:r,prev:q.call(Array(e+1),r)}}function or(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+q.call(t,","+r)+`
`+e.prev}function pt(t,e){var r=ir(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=X(t,i)?e(t[i],t):""}var o=typeof Zt=="function"?Zt(t):[],s;if(Se){s={};for(var a=0;a<o.length;a++)s["$"+o[a]]=o[a]}for(var c in t)X(t,c)&&(r&&String(Number(c))===c&&c<t.length||Se&&s["$"+c]instanceof Symbol||(ui.call(/[^\w$]/,c)?n.push(e(c,t)+": "+e(t[c],t)):n.push(c+": "+e(t[c],t))));if(typeof Zt=="function")for(var l=0;l<o.length;l++)fi.call(t,o[l])&&n.push("["+e(o[l])+"]: "+e(t[o[l]],t));return n}});var vi=h((gl,bi)=>{"use strict";var wi=se(),Ee=Xn(),fa=gi(),pa=ye(),yt=wi("%WeakMap%",!0),mt=wi("%Map%",!0),ha=Ee("WeakMap.prototype.get",!0),da=Ee("WeakMap.prototype.set",!0),ya=Ee("WeakMap.prototype.has",!0),ma=Ee("Map.prototype.get",!0),ga=Ee("Map.prototype.set",!0),wa=Ee("Map.prototype.has",!0),lr=function(t,e){for(var r=t,n;(n=r.next)!==null;r=n)if(n.key===e)return r.next=n.next,n.next=t.next,t.next=n,n},ba=function(t,e){var r=lr(t,e);return r&&r.value},va=function(t,e,r){var n=lr(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},Sa=function(t,e){return!!lr(t,e)};bi.exports=function(){var e,r,n,i={assert:function(o){if(!i.has(o))throw new pa("Side channel does not contain "+fa(o))},get:function(o){if(yt&&o&&(typeof o=="object"||typeof o=="function")){if(e)return ha(e,o)}else if(mt){if(r)return ma(r,o)}else if(n)return ba(n,o)},has:function(o){if(yt&&o&&(typeof o=="object"||typeof o=="function")){if(e)return ya(e,o)}else if(mt){if(r)return wa(r,o)}else if(n)return Sa(n,o);return!1},set:function(o,s){yt&&o&&(typeof o=="object"||typeof o=="function")?(e||(e=new yt),da(e,o,s)):mt?(r||(r=new mt),ga(r,o,s)):(n||(n={key:{},next:null}),va(n,o,s))}};return i}});var gt=h((wl,Si)=>{"use strict";var Ea=String.prototype.replace,_a=/%20/g,ur={RFC1738:"RFC1738",RFC3986:"RFC3986"};Si.exports={default:ur.RFC3986,formatters:{RFC1738:function(t){return Ea.call(t,_a,"+")},RFC3986:function(t){return String(t)}},RFC1738:ur.RFC1738,RFC3986:ur.RFC3986}});var hr=h((bl,_i)=>{"use strict";var Aa=gt(),fr=Object.prototype.hasOwnProperty,ae=Array.isArray,F=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),xa=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(ae(n)){for(var i=[],o=0;o<n.length;++o)typeof n[o]<"u"&&i.push(n[o]);r.obj[r.prop]=i}}},Ei=function(e,r){for(var n=r&&r.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(n[i]=e[i]);return n},Ta=function t(e,r,n){if(!r)return e;if(typeof r!="object"){if(ae(e))e.push(r);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!fr.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object")return[e].concat(r);var i=e;return ae(e)&&!ae(r)&&(i=Ei(e,n)),ae(e)&&ae(r)?(r.forEach(function(o,s){if(fr.call(e,s)){var a=e[s];a&&typeof a=="object"&&o&&typeof o=="object"?e[s]=t(a,o,n):e.push(o)}else e[s]=o}),e):Object.keys(r).reduce(function(o,s){var a=r[s];return fr.call(o,s)?o[s]=t(o[s],a,n):o[s]=a,o},i)},Oa=function(e,r){return Object.keys(r).reduce(function(n,i){return n[i]=r[i],n},e)},ka=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},pr=1024,Ra=function(e,r,n,i,o){if(e.length===0)return e;var s=e;if(typeof e=="symbol"?s=Symbol.prototype.toString.call(e):typeof e!="string"&&(s=String(e)),n==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(m){return"%26%23"+parseInt(m.slice(2),16)+"%3B"});for(var a="",c=0;c<s.length;c+=pr){for(var l=s.length>=pr?s.slice(c,c+pr):s,f=[],p=0;p<l.length;++p){var u=l.charCodeAt(p);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===Aa.RFC1738&&(u===40||u===41)){f[f.length]=l.charAt(p);continue}if(u<128){f[f.length]=F[u];continue}if(u<2048){f[f.length]=F[192|u>>6]+F[128|u&63];continue}if(u<55296||u>=57344){f[f.length]=F[224|u>>12]+F[128|u>>6&63]+F[128|u&63];continue}p+=1,u=65536+((u&1023)<<10|l.charCodeAt(p)&1023),f[f.length]=F[240|u>>18]+F[128|u>>12&63]+F[128|u>>6&63]+F[128|u&63]}a+=f.join("")}return a},Ca=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],i=0;i<r.length;++i)for(var o=r[i],s=o.obj[o.prop],a=Object.keys(s),c=0;c<a.length;++c){var l=a[c],f=s[l];typeof f=="object"&&f!==null&&n.indexOf(f)===-1&&(r.push({obj:s,prop:l}),n.push(f))}return xa(r),e},Pa=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},$a=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},Ia=function(e,r){return[].concat(e,r)},Na=function(e,r){if(ae(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(r(e[i]));return n}return r(e)};_i.exports={arrayToObject:Ei,assign:Oa,combine:Ia,compact:Ca,decode:ka,encode:Ra,isBuffer:$a,isRegExp:Pa,maybeMap:Na,merge:Ta}});var Ri=h((vl,ki)=>{"use strict";var xi=vi(),wt=hr(),Fe=gt(),Da=Object.prototype.hasOwnProperty,Ti={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},U=Array.isArray,La=Array.prototype.push,Oi=function(t,e){La.apply(t,U(e)?e:[e])},Ba=Date.prototype.toISOString,Ai=Fe.default,A={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:wt.encode,encodeValuesOnly:!1,format:Ai,formatter:Fe.formatters[Ai],indices:!1,serializeDate:function(e){return Ba.call(e)},skipNulls:!1,strictNullHandling:!1},qa=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},dr={},Fa=function t(e,r,n,i,o,s,a,c,l,f,p,u,m,v,x,P,I,z){for(var g=e,V=z,ee=0,Pe=!1;(V=V.get(dr))!==void 0&&!Pe;){var pe=V.get(e);if(ee+=1,typeof pe<"u"){if(pe===ee)throw new RangeError("Cyclic object value");Pe=!0}typeof V.get(dr)>"u"&&(ee=0)}if(typeof f=="function"?g=f(r,g):g instanceof Date?g=m(g):n==="comma"&&U(g)&&(g=wt.maybeMap(g,function(Ft){return Ft instanceof Date?m(Ft):Ft})),g===null){if(s)return l&&!P?l(r,A.encoder,I,"key",v):r;g=""}if(qa(g)||wt.isBuffer(g)){if(l){var tt=P?r:l(r,A.encoder,I,"key",v);return[x(tt)+"="+x(l(g,A.encoder,I,"value",v))]}return[x(r)+"="+x(String(g))]}var te=[];if(typeof g>"u")return te;var K;if(n==="comma"&&U(g))P&&l&&(g=wt.maybeMap(g,l)),K=[{value:g.length>0?g.join(",")||null:void 0}];else if(U(f))K=f;else{var rt=Object.keys(g);K=p?rt.sort(p):rt}var he=c?r.replace(/\./g,"%2E"):r,L=i&&U(g)&&g.length===1?he+"[]":he;if(o&&U(g)&&g.length===0)return L+"[]";for(var Y=0;Y<K.length;++Y){var J=K[Y],$e=typeof J=="object"&&typeof J.value<"u"?J.value:g[J];if(!(a&&$e===null)){var qt=u&&c?J.replace(/\./g,"%2E"):J,zo=U(g)?typeof n=="function"?n(L,qt):L:L+(u?"."+qt:"["+qt+"]");z.set(e,ee);var Mr=xi();Mr.set(dr,z),Oi(te,t($e,zo,n,i,o,s,a,c,n==="comma"&&P&&U(g)?null:l,f,p,u,m,v,x,P,I,Mr))}}return te},Ua=function(e){if(!e)return A;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||A.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Fe.default;if(typeof e.format<"u"){if(!Da.call(Fe.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=Fe.formatters[n],o=A.filter;(typeof e.filter=="function"||U(e.filter))&&(o=e.filter);var s;if(e.arrayFormat in Ti?s=e.arrayFormat:"indices"in e?s=e.indices?"indices":"repeat":s=A.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:A.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:A.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:A.allowEmptyArrays,arrayFormat:s,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:A.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?A.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:A.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:A.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:A.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:A.encodeValuesOnly,filter:o,format:n,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:A.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:A.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:A.strictNullHandling}};ki.exports=function(t,e){var r=t,n=Ua(e),i,o;typeof n.filter=="function"?(o=n.filter,r=o("",r)):U(n.filter)&&(o=n.filter,i=o);var s=[];if(typeof r!="object"||r===null)return"";var a=Ti[n.arrayFormat],c=a==="comma"&&n.commaRoundTrip;i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var l=xi(),f=0;f<i.length;++f){var p=i[f];n.skipNulls&&r[p]===null||Oi(s,Fa(r[p],p,a,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,l))}var u=s.join(n.delimiter),m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),u.length>0?m+u:""}});var $i=h((Sl,Pi)=>{"use strict";var _e=hr(),yr=Object.prototype.hasOwnProperty,Ma=Array.isArray,_={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:_e.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ha=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},Ci=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},Wa="utf8=%26%2310003%3B",Ga="utf8=%E2%9C%93",za=function(e,r){var n={__proto__:null},i=r.ignoreQueryPrefix?e.replace(/^\?/,""):e,o=r.parameterLimit===1/0?void 0:r.parameterLimit,s=i.split(r.delimiter,o),a=-1,c,l=r.charset;if(r.charsetSentinel)for(c=0;c<s.length;++c)s[c].indexOf("utf8=")===0&&(s[c]===Ga?l="utf-8":s[c]===Wa&&(l="iso-8859-1"),a=c,c=s.length);for(c=0;c<s.length;++c)if(c!==a){var f=s[c],p=f.indexOf("]="),u=p===-1?f.indexOf("="):p+1,m,v;u===-1?(m=r.decoder(f,_.decoder,l,"key"),v=r.strictNullHandling?null:""):(m=r.decoder(f.slice(0,u),_.decoder,l,"key"),v=_e.maybeMap(Ci(f.slice(u+1),r),function(P){return r.decoder(P,_.decoder,l,"value")})),v&&r.interpretNumericEntities&&l==="iso-8859-1"&&(v=Ha(v)),f.indexOf("[]=")>-1&&(v=Ma(v)?[v]:v);var x=yr.call(n,m);x&&r.duplicates==="combine"?n[m]=_e.combine(n[m],v):(!x||r.duplicates==="last")&&(n[m]=v)}return n},Va=function(t,e,r,n){for(var i=n?e:Ci(e,r),o=t.length-1;o>=0;--o){var s,a=t[o];if(a==="[]"&&r.parseArrays)s=r.allowEmptyArrays&&i===""?[]:[].concat(i);else{s=r.plainObjects?Object.create(null):{};var c=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,l=r.decodeDotInKeys?c.replace(/%2E/g,"."):c,f=parseInt(l,10);!r.parseArrays&&l===""?s={0:i}:!isNaN(f)&&a!==l&&String(f)===l&&f>=0&&r.parseArrays&&f<=r.arrayLimit?(s=[],s[f]=i):l!=="__proto__"&&(s[l]=i)}i=s}return i},Ka=function(e,r,n,i){if(e){var o=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,c=n.depth>0&&s.exec(o),l=c?o.slice(0,c.index):o,f=[];if(l){if(!n.plainObjects&&yr.call(Object.prototype,l)&&!n.allowPrototypes)return;f.push(l)}for(var p=0;n.depth>0&&(c=a.exec(o))!==null&&p<n.depth;){if(p+=1,!n.plainObjects&&yr.call(Object.prototype,c[1].slice(1,-1))&&!n.allowPrototypes)return;f.push(c[1])}return c&&f.push("["+o.slice(c.index)+"]"),Va(f,r,n,i)}},Ya=function(e){if(!e)return _;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof e.charset>"u"?_.charset:e.charset,n=typeof e.duplicates>"u"?_.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:_.allowDots:!!e.allowDots;return{allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:_.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:_.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:_.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:_.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:_.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:_.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:_.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:_.decoder,delimiter:typeof e.delimiter=="string"||_e.isRegExp(e.delimiter)?e.delimiter:_.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:_.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:_.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:_.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:_.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:_.strictNullHandling}};Pi.exports=function(t,e){var r=Ya(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?Object.create(null):{};for(var n=typeof t=="string"?za(t,r):t,i=r.plainObjects?Object.create(null):{},o=Object.keys(n),s=0;s<o.length;++s){var a=o[s],c=Ka(a,n[a],r,typeof t=="string");i=_e.merge(i,c,r)}return r.allowSparse===!0?i:_e.compact(i)}});var Ni=h((El,Ii)=>{"use strict";var Ja=Ri(),Xa=$i(),ja=gt();Ii.exports={formats:ja,parse:Xa,stringify:Ja}});var Di=h(()=>{});var bt=h(M=>{"use strict";function Bi(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Qa(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return o=l.done,l},e:function(l){s=!0,a=l},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(s)throw a}}}}function Qa(t,e){if(t){if(typeof t=="string")return Li(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Li(t,e)}}function Li(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}M.type=t=>t.split(/ *; */).shift();M.params=t=>{let e={};var r=Bi(t.split(/ *; */)),n;try{for(r.s();!(n=r.n()).done;){let o=n.value.split(/ *= */),s=o.shift(),a=o.shift();s&&a&&(e[s]=a)}}catch(i){r.e(i)}finally{r.f()}return e};M.parseLinks=t=>{let e={};var r=Bi(t.split(/ *, */)),n;try{for(r.s();!(n=r.n()).done;){let o=n.value.split(/ *; */),s=o[0].slice(1,-1),a=o[1].split(/ *= */)[1].slice(1,-1);e[a]=s}}catch(i){r.e(i)}finally{r.f()}return e};M.cleanHeader=(t,e)=>(delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&(delete t.authorization,delete t.cookie),t);M.isObject=t=>t!==null&&typeof t=="object";M.hasOwn=Object.hasOwn||function(t,e){if(t==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(new Object(t),e)};M.mixin=(t,e)=>{for(let r in e)M.hasOwn(e,r)&&(t[r]=e[r])}});var Mi=h((Tl,Ui)=>{"use strict";var qi=Di(),Fi=bt(),vt=Fi.isObject,Ue=Fi.hasOwn;Ui.exports=w;function w(){}w.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this};w.prototype.parse=function(t){return this._parser=t,this};w.prototype.responseType=function(t){return this._responseType=t,this};w.prototype.serialize=function(t){return this._serializer=t,this};w.prototype.timeout=function(t){if(!t||typeof t!="object")return this._timeout=t,this._responseTimeout=0,this._uploadTimeout=0,this;for(let e in t)if(Ue(t,e))switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;case"upload":this._uploadTimeout=t.upload;break;default:console.warn("Unknown timeout option",e)}return this};w.prototype.retry=function(t,e){return(arguments.length===0||t===!0)&&(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var Za=new Set(["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"]),ec=new Set([408,413,429,500,502,503,504,521,522,524]);w.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{let r=this._retryCallback(t,e);if(r===!0)return!0;if(r===!1)return!1}catch(r){console.error(r)}return!!(e&&e.status&&ec.has(e.status)||t&&(t.code&&Za.has(t.code)||t.timeout&&t.code==="ECONNABORTED"||t.crossDomain))};w.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()};w.prototype.then=function(t,e){if(!this._fullfilledPromise){let r=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise((n,i)=>{r.on("abort",()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError){i(this.timedoutError);return}let o=new Error("Aborted");o.code="ABORTED",o.status=this.status,o.method=this.method,o.url=this.url,i(o)}),r.end((o,s)=>{o?i(o):n(s)})})}return this._fullfilledPromise.then(t,e)};w.prototype.catch=function(t){return this.then(void 0,t)};w.prototype.use=function(t){return t(this),this};w.prototype.ok=function(t){if(typeof t!="function")throw new Error("Callback required");return this._okCallback=t,this};w.prototype._isResponseOK=function(t){return t?this._okCallback?this._okCallback(t):t.status>=200&&t.status<300:!1};w.prototype.get=function(t){return this._header[t.toLowerCase()]};w.prototype.getHeader=w.prototype.get;w.prototype.set=function(t,e){if(vt(t)){for(let r in t)Ue(t,r)&&this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this};w.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this};w.prototype.field=function(t,e,r){if(t==null)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(vt(t)){for(let n in t)Ue(t,n)&&this.field(n,t[n]);return this}if(Array.isArray(e)){for(let n in e)Ue(e,n)&&this.field(t,e[n]);return this}if(e==null)throw new Error(".field(name, val) val can not be empty");return typeof e=="boolean"&&(e=String(e)),r?this._getFormData().append(t,e,r):this._getFormData().append(t,e),this};w.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(qi.gte(process.version,"v13.0.0")&&qi.lt(process.version,"v14.0.0"))throw new Error("Superagent does not work in v13 properly with abort() due to Node.js core changes");this.req.abort()}return this.clearTimeout(),this.emit("abort"),this};w.prototype._auth=function(t,e,r,n){switch(r.type){case"basic":this.set("Authorization",`Basic ${n(`${t}:${e}`)}`);break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization",`Bearer ${t}`);break;default:break}return this};w.prototype.withCredentials=function(t){return t===void 0&&(t=!0),this._withCredentials=t,this};w.prototype.redirects=function(t){return this._maxRedirects=t,this};w.prototype.maxResponseSize=function(t){if(typeof t!="number")throw new TypeError("Invalid argument");return this._maxResponseSize=t,this};w.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}};w.prototype.send=function(t){let e=vt(t),r=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(e&&vt(this._data))for(let n in t){if(typeof t[n]=="bigint"&&!t[n].toJSON)throw new Error("Cannot serialize BigInt value to json");Ue(t,n)&&(this._data[n]=t[n])}else{if(typeof t=="bigint")throw new Error("Cannot send value of type BigInt");typeof t=="string"?(r||this.type("form"),r=this._header["content-type"],r&&(r=r.toLowerCase().trim()),r==="application/x-www-form-urlencoded"?this._data=this._data?`${this._data}&${t}`:t:this._data=(this._data||"")+t):this._data=t}return!e||this._isHost(t)?this:(r||this.type("json"),this)};w.prototype.sortQuery=function(t){return this._sort=typeof t>"u"?!0:t,this};w.prototype._finalizeQueryString=function(){let t=this._query.join("&");if(t&&(this.url+=(this.url.includes("?")?"&":"?")+t),this._query.length=0,this._sort){let e=this.url.indexOf("?");if(e>=0){let r=this.url.slice(e+1).split("&");typeof this._sort=="function"?r.sort(this._sort):r.sort(),this.url=this.url.slice(0,e)+"?"+r.join("&")}}};w.prototype._appendQueryString=()=>{console.warn("Unsupported")};w.prototype._timeoutError=function(t,e,r){if(this._aborted)return;let n=new Error(`${t+e}ms exceeded`);n.timeout=e,n.code="ECONNABORTED",n.errno=r,this.timedout=!0,this.timedoutError=n,this.abort(),this.callback(n)};w.prototype._setTimeouts=function(){let t=this;this._timeout&&!this._timer&&(this._timer=setTimeout(()=>{t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(()=>{t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}});var Wi=h((Ol,Hi)=>{"use strict";var mr=bt();Hi.exports=St;function St(){}St.prototype.get=function(t){return this.header[t.toLowerCase()]};St.prototype._setHeaderProperties=function(t){let e=t["content-type"]||"";this.type=mr.type(e);let r=mr.params(e);for(let n in r)Object.prototype.hasOwnProperty.call(r,n)&&(this[n]=r[n]);this.links={};try{t.link&&(this.links=mr.parseLinks(t.link))}catch{}};St.prototype._setStatusProperties=function(t){let e=Math.trunc(t/100);this.statusCode=t,this.status=this.statusCode,this.statusType=e,this.info=e===1,this.ok=e===2,this.redirect=e===3,this.clientError=e===4,this.serverError=e===5,this.error=e===4||e===5?this.toError():!1,this.created=t===201,this.accepted=t===202,this.noContent=t===204,this.badRequest=t===400,this.unauthorized=t===401,this.notAcceptable=t===406,this.forbidden=t===403,this.notFound=t===404,this.unprocessableEntity=t===422}});var Vi=h((kl,zi)=>{"use strict";function tc(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=rc(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return o=l.done,l},e:function(l){s=!0,a=l},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(s)throw a}}}}function rc(t,e){if(t){if(typeof t=="string")return Gi(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gi(t,e)}}function Gi(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wr(){this._defaults=[]}for(Et=0,gr=["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert","disableTLSCerts"];Et<gr.length;Et++){let t=gr[Et];wr.prototype[t]=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this._defaults.push({fn:t,args:r}),this}}var Et,gr;wr.prototype._setDefaults=function(t){var e=tc(this._defaults),r;try{for(e.s();!(r=e.n()).done;){let n=r.value;t[n.fn](...n.args)}}catch(n){e.e(n)}finally{e.f()}};zi.exports=wr});var xe=h((ce,_r)=>{"use strict";function nc(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=ic(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,s=!1,a;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return o=l.done,l},e:function(l){s=!0,a=l},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(s)throw a}}}}function ic(t,e){if(t){if(typeof t=="string")return Ki(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ki(t,e)}}function Ki(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Ae;typeof window<"u"?Ae=window:typeof self>"u"?(console.warn("Using browser-only version of superagent in non-browser environment"),Ae=void 0):Ae=self;var oc=Wr(),sc=Jr(),ac=Ni(),cc=Mi(),Sr=bt(),Yi=Sr.isObject,Ji=Sr.mixin,Er=Sr.hasOwn,lc=Wi(),At=Vi();function uc(){}_r.exports=function(t,e){return typeof e=="function"?new ce.Request("GET",t).end(e):arguments.length===1?new ce.Request("GET",t):new ce.Request(t,e)};ce=_r.exports;var b=ce;ce.Request=E;b.getXHR=()=>{if(Ae.XMLHttpRequest)return new Ae.XMLHttpRequest;throw new Error("Browser-only version of superagent could not find XHR")};var fc="".trim?t=>t.trim():t=>t.replace(/(^\s*|\s*$)/g,"");function Xi(t){if(!Yi(t))return t;let e=[];for(let r in t)Er(t,r)&&vr(e,r,t[r]);return e.join("&")}function vr(t,e,r){if(r!==void 0){if(r===null){t.push(encodeURI(e));return}if(Array.isArray(r)){var n=nc(r),i;try{for(n.s();!(i=n.n()).done;){let o=i.value;vr(t,e,o)}}catch(o){n.e(o)}finally{n.f()}}else if(Yi(r))for(let o in r)Er(r,o)&&vr(t,`${e}[${o}]`,r[o]);else t.push(encodeURI(e)+"="+encodeURIComponent(r))}}b.serializeObject=Xi;function ji(t){let e={},r=t.split("&"),n,i;for(let o=0,s=r.length;o<s;++o)n=r[o],i=n.indexOf("="),i===-1?e[decodeURIComponent(n)]="":e[decodeURIComponent(n.slice(0,i))]=decodeURIComponent(n.slice(i+1));return e}b.parseString=ji;b.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"};b.serialize={"application/x-www-form-urlencoded":ac.stringify,"application/json":sc};b.parse={"application/x-www-form-urlencoded":ji,"application/json":JSON.parse};function pc(t){let e=t.split(/\r?\n/),r={},n,i,o,s;for(let a=0,c=e.length;a<c;++a)i=e[a],n=i.indexOf(":"),n!==-1&&(o=i.slice(0,n).toLowerCase(),s=fc(i.slice(n+1)),r[o]=s);return r}function Qi(t){return/[/+]json($|[^-\w])/i.test(t)}function Me(t){this.req=t,this.xhr=this.req.xhr,this.text=this.req.method!=="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType>"u"?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let e=this.xhr.status;e===1223&&(e=204),this._setStatusProperties(e),this.headers=pc(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.text===null&&t._responseType?this.body=this.xhr.response:this.body=this.req.method==="HEAD"?null:this._parseBody(this.text?this.text:this.xhr.response)}Ji(Me.prototype,lc.prototype);Me.prototype._parseBody=function(t){let e=b.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&Qi(this.type)&&(e=b.parse["application/json"]),e&&t&&(t.length>0||t instanceof Object)?e(t):null)};Me.prototype.toError=function(){let t=this.req,e=t.method,r=t.url,n=`cannot ${e} ${r} (${this.status})`,i=new Error(n);return i.status=this.status,i.method=e,i.url=r,i};b.Response=Me;function E(t,e){let r=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",()=>{let n=null,i=null;try{i=new Me(r)}catch(s){return n=new Error("Parser is unable to parse the response"),n.parse=!0,n.original=s,r.xhr?(n.rawResponse=typeof r.xhr.responseType>"u"?r.xhr.responseText:r.xhr.response,n.status=r.xhr.status?r.xhr.status:null,n.statusCode=n.status):(n.rawResponse=null,n.status=null),r.callback(n)}r.emit("response",i);let o;try{r._isResponseOK(i)||(o=new Error(i.statusText||i.text||"Unsuccessful HTTP response"))}catch(s){o=s}o?(o.original=n,o.response=i,o.status=o.status||i.status,r.callback(o,i)):r.callback(null,i)})}oc(E.prototype);Ji(E.prototype,cc.prototype);E.prototype.type=function(t){return this.set("Content-Type",b.types[t]||t),this};E.prototype.accept=function(t){return this.set("Accept",b.types[t]||t),this};E.prototype.auth=function(t,e,r){arguments.length===1&&(e=""),typeof e=="object"&&e!==null&&(r=e,e=""),r||(r={type:typeof btoa=="function"?"basic":"auto"});let n=r.encoder?r.encoder:i=>{if(typeof btoa=="function")return btoa(i);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(t,e,r,n)};E.prototype.query=function(t){return typeof t!="string"&&(t=Xi(t)),t&&this._query.push(t),this};E.prototype.attach=function(t,e,r){if(e){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,r||e.name)}return this};E.prototype._getFormData=function(){return this._formData||(this._formData=new Ae.FormData),this._formData};E.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();let r=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),r(t,e)};E.prototype.crossDomainError=function(){let t=new Error(`Request has been terminated
Possible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.`);t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)};E.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this};E.prototype.ca=E.prototype.agent;E.prototype.buffer=E.prototype.ca;E.prototype.write=()=>{throw new Error("Streaming is not supported in browser version of superagent")};E.prototype.pipe=E.prototype.write;E.prototype._isHost=function(t){return t&&typeof t=="object"&&!Array.isArray(t)&&Object.prototype.toString.call(t)!=="[object Object]"};E.prototype.end=function(t){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||uc,this._finalizeQueryString(),this._end()};E.prototype._setUploadTimeout=function(){let t=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout(()=>{t._timeoutError("Upload timeout of ",t._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout))};E.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));let t=this;this.xhr=b.getXHR();let e=this.xhr,r=this._formData||this._data;this._setTimeouts(),e.addEventListener("readystatechange",()=>{let i=e.readyState;if(i>=2&&t._responseTimeoutTimer&&clearTimeout(t._responseTimeoutTimer),i!==4)return;let o;try{o=e.status}catch{o=0}if(!o)return t.timedout||t._aborted?void 0:t.crossDomainError();t.emit("end")});let n=(i,o)=>{o.total>0&&(o.percent=o.loaded/o.total*100,o.percent===100&&clearTimeout(t._uploadTimeoutTimer)),o.direction=i,t.emit("progress",o)};if(this.hasListeners("progress"))try{e.addEventListener("progress",n.bind(null,"download")),e.upload&&e.upload.addEventListener("progress",n.bind(null,"upload"))}catch{}e.upload&&this._setUploadTimeout();try{this.username&&this.password?e.open(this.method,this.url,!0,this.username,this.password):e.open(this.method,this.url,!0)}catch(i){return this.callback(i)}if(this._withCredentials&&(e.withCredentials=!0),!this._formData&&this.method!=="GET"&&this.method!=="HEAD"&&typeof r!="string"&&!this._isHost(r)){let i=this._header["content-type"],o=this._serializer||b.serialize[i?i.split(";")[0]:""];!o&&Qi(i)&&(o=b.serialize["application/json"]),o&&(r=o(r))}for(let i in this.header)this.header[i]!==null&&Er(this.header,i)&&e.setRequestHeader(i,this.header[i]);this._responseType&&(e.responseType=this._responseType),this.emit("request",this),e.send(typeof r>"u"?null:r)};b.agent=()=>new At;for(_t=0,br=["GET","POST","OPTIONS","PATCH","PUT","DELETE"];_t<br.length;_t++){let t=br[_t];At.prototype[t.toLowerCase()]=function(e,r){let n=new b.Request(t,e);return this._setDefaults(n),r&&n.end(r),n}}var _t,br;At.prototype.del=At.prototype.delete;b.get=(t,e,r)=>{let n=b("GET",t);return typeof e=="function"&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n};b.head=(t,e,r)=>{let n=b("HEAD",t);return typeof e=="function"&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n};b.options=(t,e,r)=>{let n=b("OPTIONS",t);return typeof e=="function"&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n};function Zi(t,e,r){let n=b("DELETE",t);return typeof e=="function"&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n}b.del=Zi;b.delete=Zi;b.patch=(t,e,r)=>{let n=b("PATCH",t);return typeof e=="function"&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n};b.post=(t,e,r)=>{let n=b("POST",t);return typeof e=="function"&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n};b.put=(t,e,r)=>{let n=b("PUT",t);return typeof e=="function"&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n}});var xr=Ie(xe());var no=Ie(xe());function R(t){window.location.pathname=`${window.site_prefix}${t}`}function H(){return window.location.pathname.replace(window.site_prefix,"")}var eo="",to=0,Ar="",ro=!1,O=class t{static get uname(){return eo}static get uid(){return to}static get token(){return Ar}static set token(e){Ar=e,window.localStorage.setItem("player-id",e)}static async init(){Ar=window.localStorage.getItem("player-id")||"";let{body:e}=await no.default.post("/user/current").send({token:t.token});e.loggedIn?(eo=e.name,to=e.uid,ro=e.isAdmin,ro&&$("body").addClass("isadmin"),H()==="/login"&&R("/")):(t.token="",H()!=="/login"&&R("/login"))}};function hc(){let t=$(".page--home > .create-game > p");t.find(".submit").on("click",async()=>{let e=t.find(".player1").val()?.toString()||"",r=t.find(".player2").val()?.toString()||"",n=t.find(".startAt").val()?.toString()||"",i=t.find(".note").val()?.toString()||"",{body:o}=await xr.default.post("/game/create").send({token:O.token,player1:e,player2:r,startAt:+n*60*1e3+Date.now(),note:i});o.error?window.alert(o.error):R("/")})}async function dc(){let{body:{list:t}}=await xr.default.post("/game/list").send({token:O.token});for(let e of t)$(".page--home > .list > table > tbody").append(`
      <tr>
        <td>${e.gameId}</td>
        <td>${e.player1}</td>
        <td>${e.player2}</td>
        <td>${new Date(e.startAt).toLocaleString()}</td>
        <td>${e.done?e.winner:"\u6E38\u620F\u672A\u7ED3\u675F"}</td>
        <td>
          ${[e.player1,e.player2].includes(O.uid)&&!e.done?`<a href="/game/${e.gameId}/play">\u8FDB\u5165</a>`:""}
          ${e.done?`<a href="/game/${e.gameId}/replay">\u56DE\u653E</a>`:""}
        </td>
        <td>${e.note}</td>
      </tr>
    `)}async function io(){dc(),hc()}var Tr=Ie(xe());async function oo(){let t=await Tr.default.post("/user/newToken").send({token:""});$(".page--login > p.token").text(t.text.trim()),$(document).on("click",".page--login button.submit",async()=>{let e=($(".page--login .paste-id").val()?.toString()||"").trim(),{body:r}=await Tr.default.post("/user/login/luogu").send({pasteId:e,token:""});r.error?window.alert(r.error):(O.token=r.token,R("/"))})}var Mo=Ie(xe());var B=Object.create(null);B.open="0";B.close="1";B.ping="2";B.pong="3";B.message="4";B.upgrade="5";B.noop="6";var He=Object.create(null);Object.keys(B).forEach(t=>{He[B[t]]=t});var We={type:"error",data:"parser error"};var co=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",lo=typeof ArrayBuffer=="function",uo=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Ge=({type:t,data:e},r,n)=>co&&e instanceof Blob?r?n(e):so(e,n):lo&&(e instanceof ArrayBuffer||uo(e))?r?n(e):so(new Blob([e]),n):n(B[t]+(e||"")),so=(t,e)=>{let r=new FileReader;return r.onload=function(){let n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};function ao(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}var Or;function fo(t,e){if(co&&t.data instanceof Blob)return t.data.arrayBuffer().then(ao).then(e);if(lo&&(t.data instanceof ArrayBuffer||uo(t.data)))return e(ao(t.data));Ge(t,!1,r=>{Or||(Or=new TextEncoder),e(Or.encode(r))})}var po="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ze=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<po.length;t++)ze[po.charCodeAt(t)]=t;var ho=t=>{let e=t.length*.75,r=t.length,n,i=0,o,s,a,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);let l=new ArrayBuffer(e),f=new Uint8Array(l);for(n=0;n<r;n+=4)o=ze[t.charCodeAt(n)],s=ze[t.charCodeAt(n+1)],a=ze[t.charCodeAt(n+2)],c=ze[t.charCodeAt(n+3)],f[i++]=o<<2|s>>4,f[i++]=(s&15)<<4|a>>2,f[i++]=(a&3)<<6|c&63;return l};var gc=typeof ArrayBuffer=="function",Ve=(t,e)=>{if(typeof t!="string")return{type:"message",data:yo(t,e)};let r=t.charAt(0);return r==="b"?{type:"message",data:wc(t.substring(1),e)}:He[r]?t.length>1?{type:He[r],data:t.substring(1)}:{type:He[r]}:We},wc=(t,e)=>{if(gc){let r=ho(t);return yo(r,e)}else return{base64:!0,data:t}},yo=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}};var mo="",go=(t,e)=>{let r=t.length,n=new Array(r),i=0;t.forEach((o,s)=>{Ge(o,!1,a=>{n[s]=a,++i===r&&e(n.join(mo))})})},wo=(t,e)=>{let r=t.split(mo),n=[];for(let i=0;i<r.length;i++){let o=Ve(r[i],e);if(n.push(o),o.type==="error")break}return n};function bo(){return new TransformStream({transform(t,e){fo(t,r=>{let n=r.length,i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);let o=new DataView(i.buffer);o.setUint8(0,126),o.setUint16(1,n)}else{i=new Uint8Array(9);let o=new DataView(i.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(r)})}})}var kr;function xt(t){return t.reduce((e,r)=>e+r.length,0)}function Tt(t,e){if(t[0].length===e)return t.shift();let r=new Uint8Array(e),n=0;for(let i=0;i<e;i++)r[i]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function vo(t,e){kr||(kr=new TextDecoder);let r=[],n=0,i=-1,o=!1;return new TransformStream({transform(s,a){for(r.push(s);;){if(n===0){if(xt(r)<1)break;let c=Tt(r,1);o=(c[0]&128)===128,i=c[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(xt(r)<2)break;let c=Tt(r,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(xt(r)<8)break;let c=Tt(r,8),l=new DataView(c.buffer,c.byteOffset,c.length),f=l.getUint32(0);if(f>Math.pow(2,21)-1){a.enqueue(We);break}i=f*Math.pow(2,32)+l.getUint32(4),n=3}else{if(xt(r)<i)break;let c=Tt(r,i);a.enqueue(Ve(o?c:kr.decode(c),e)),n=0}if(i===0||i>t){a.enqueue(We);break}}}})}var Rr=4;function S(t){if(t)return bc(t)}function bc(t){for(var e in S.prototype)t[e]=S.prototype[e];return t}S.prototype.on=S.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};S.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};S.prototype.off=S.prototype.removeListener=S.prototype.removeAllListeners=S.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};S.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};S.prototype.emitReserved=S.prototype.emit;S.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};S.prototype.hasListeners=function(t){return!!this.listeners(t).length};var C=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function Ot(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}var vc=C.setTimeout,Sc=C.clearTimeout;function W(t,e){e.useNativeTimers?(t.setTimeoutFn=vc.bind(C),t.clearTimeoutFn=Sc.bind(C)):(t.setTimeoutFn=C.setTimeout.bind(C),t.clearTimeoutFn=C.clearTimeout.bind(C))}var Ec=1.33;function So(t){return typeof t=="string"?_c(t):Math.ceil((t.byteLength||t.size)*Ec)}function _c(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function Eo(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function _o(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let o=r[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}var kt=class extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}},G=class extends S{constructor(e){super(),this.writable=!1,W(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,r,n){return super.emitReserved("error",new kt(e,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let r=Ve(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,r={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){let e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){let r=Eo(e);return r.length?"?"+r:""}};var Oo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Cr=64,Ac={},Ao=0,Rt=0,xo;function To(t){let e="";do e=Oo[t%Cr]+e,t=Math.floor(t/Cr);while(t>0);return e}function Ct(){let t=To(+new Date);return t!==xo?(Ao=0,xo=t):t+"."+To(Ao++)}for(;Rt<Cr;Rt++)Ac[Oo[Rt]]=Rt;var ko=!1;try{ko=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var Ro=ko;function Pr(t){let e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Ro))return new XMLHttpRequest}catch{}if(!e)try{return new C[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function xc(){}var Tc=function(){return new Pr({xdomain:!1}).responseType!=null}(),Pt=class extends G{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){let n=location.protocol==="https:",i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}let r=e&&e.forceBase64;this.supportsBinary=Tc&&!r,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let r=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let n=0;this.polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};wo(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,go(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=Ct()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(e,r)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Z(this.uri(),e)}doWrite(e,r){let n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(i,o)=>{this.onError("xhr post error",i,o)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}},Z=class t extends S{constructor(e,r){super(),W(this,r),this.opts=r,this.method=r.method||"GET",this.uri=e,this.data=r.data!==void 0?r.data:null,this.create()}create(){var e;let r=Ot(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this.opts.xd;let n=this.xhr=new Pr(r);try{n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this.opts.extraHeaders[i])}}catch{}if(this.method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this.opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this.opts.cookieJar)===null||i===void 0||i.parseCookies(n)),n.readyState===4&&(n.status===200||n.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof n.status=="number"?n.status:0)},0))},n.send(this.data)}catch(i){this.setTimeoutFn(()=>{this.onError(i)},0);return}typeof document<"u"&&(this.index=t.requestsCount++,t.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=xc,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete t.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};Z.requestsCount=0;Z.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Co);else if(typeof addEventListener=="function"){let t="onpagehide"in C?"pagehide":"unload";addEventListener(t,Co,!1)}}function Co(){for(let t in Z.requests)Z.requests.hasOwnProperty(t)&&Z.requests[t].abort()}var le=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0),Ke=C.WebSocket||C.MozWebSocket,$t=!0,Po="arraybuffer";var $o=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",It=class extends G{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),r=this.opts.protocols,n=$o?{}:Ot(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=$t&&!$o?r?new Ke(e,r):new Ke(e):new Ke(e,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){let n=e[r],i=r===e.length-1;Ge(n,this.supportsBinary,o=>{let s={};$t||(n.options&&(s.compress=n.options.compress),this.opts.perMessageDeflate&&(typeof o=="string"?Buffer.byteLength(o):o.length)<this.opts.perMessageDeflate.threshold&&(s.compress=!1));try{$t?this.ws.send(o):this.ws.send(o,s)}catch{}i&&le(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=Ct()),this.supportsBinary||(r.b64=1),this.createUri(e,r)}check(){return!!Ke}};var Nt=class extends G{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{let r=vo(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(r).getReader(),i=bo();i.readable.pipeTo(e.writable),this.writer=i.writable.getWriter();let o=()=>{n.read().then(({done:a,value:c})=>{a||(this.onPacket(c),o())}).catch(a=>{})};o();let s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this.writer.write(s).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let r=0;r<e.length;r++){let n=e[r],i=r===e.length-1;this.writer.write(n).then(()=>{i&&le(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}};var $r={websocket:It,webtransport:Nt,polling:Pt};var Oc=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,kc=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Te(t){if(t.length>2e3)throw"URI too long";let e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=Oc.exec(t||""),o={},s=14;for(;s--;)o[kc[s]]=i[s]||"";return r!=-1&&n!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=Rc(o,o.path),o.queryKey=Cc(o,o.query),o}function Rc(t,e){let r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function Cc(t,e){let r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,o){i&&(r[i]=o)}),r}var ue=class t extends S{constructor(e,r={}){super(),this.binaryType=Po,this.writeBuffer=[],e&&typeof e=="object"&&(r=e,e=null),e?(e=Te(e),r.hostname=e.host,r.secure=e.protocol==="https"||e.protocol==="wss",r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=Te(r.host).host),W(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=r.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=_o(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){let r=Object.assign({},this.opts.query);r.EIO=Rr,r.transport=e,this.id&&(r.sid=this.id);let n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new $r[e](n)}open(){let e;if(this.opts.rememberUpgrade&&t.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",r=>this.onClose("transport close",r))}probe(e){let r=this.createTransport(e),n=!1;t.priorWebsocketSuccess=!1;let i=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!n)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;t.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(f(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{let u=new Error("probe error");u.transport=r.name,this.emitReserved("upgradeError",u)}}))};function o(){n||(n=!0,f(),r.close(),r=null)}let s=p=>{let u=new Error("probe error: "+p);u.transport=r.name,o(),this.emitReserved("upgradeError",u)};function a(){s("transport closed")}function c(){s("socket closed")}function l(p){r&&p.name!==r.name&&o()}let f=()=>{r.removeListener("open",i),r.removeListener("error",s),r.removeListener("close",a),this.off("close",c),this.off("upgrading",l)};r.once("open",i),r.once("error",s),r.once("close",a),this.once("close",c),this.once("upgrading",l),this.upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onOpen(){if(this.readyState="open",t.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0,r=this.upgrades.length;for(;e<r;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let r=new Error("server error");r.code=e.data,this.onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){let i=this.writeBuffer[n].data;if(i&&(r+=So(i)),n>0&&r>this.maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}write(e,r,n){return this.sendPacket("message",e,r,n),this}send(e,r,n){return this.sendPacket("message",e,r,n),this}sendPacket(e,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;let o={type:e,data:r,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),i&&this.once("flush",i),this.flush()}close(){let e=()=>{this.onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}onError(e){t.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let r=[],n=0,i=e.length;for(;n<i;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}};ue.protocol=Rr;var Wu=ue.protocol;function Io(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=Te(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let o=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port+e,n.href=n.protocol+"://"+o+(r&&r.port===n.port?"":":"+n.port),n}var qr={};Hr(qr,{Decoder:()=>Lr,Encoder:()=>Dr,PacketType:()=>y,protocol:()=>qo});var Pc=typeof ArrayBuffer=="function",$c=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,No=Object.prototype.toString,Ic=typeof Blob=="function"||typeof Blob<"u"&&No.call(Blob)==="[object BlobConstructor]",Nc=typeof File=="function"||typeof File<"u"&&No.call(File)==="[object FileConstructor]";function Je(t){return Pc&&(t instanceof ArrayBuffer||$c(t))||Ic&&t instanceof Blob||Nc&&t instanceof File}function Ye(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(Ye(t[r]))return!0;return!1}if(Je(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Ye(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&Ye(t[r]))return!0;return!1}function Do(t){let e=[],r=t.data,n=t;return n.data=Ir(r,e),n.attachments=e.length,{packet:n,buffers:e}}function Ir(t,e){if(!t)return t;if(Je(t)){let r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){let r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=Ir(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){let r={};for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=Ir(t[n],e));return r}return t}function Lo(t,e){return t.data=Nr(t.data,e),delete t.attachments,t}function Nr(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=Nr(t[r],e);else if(typeof t=="object")for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=Nr(t[r],e));return t}var Dc=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],qo=5,y;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(y||(y={}));var Dr=class{constructor(e){this.replacer=e}encode(e){return(e.type===y.EVENT||e.type===y.ACK)&&Ye(e)?this.encodeAsBinary({type:e.type===y.EVENT?y.BINARY_EVENT:y.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===y.BINARY_EVENT||e.type===y.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){let r=Do(e),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}};function Bo(t){return Object.prototype.toString.call(t)==="[object Object]"}var Lr=class t extends S{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);let n=r.type===y.BINARY_EVENT;n||r.type===y.BINARY_ACK?(r.type=n?y.EVENT:y.ACK,this.reconstructor=new Br(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Je(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0,n={type:Number(e.charAt(0))};if(y[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===y.BINARY_EVENT||n.type===y.BINARY_ACK){let o=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);let s=e.substring(o,r);if(s!=Number(s)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(s)}if(e.charAt(r+1)==="/"){let o=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(o,r)}else n.nsp="/";let i=e.charAt(r+1);if(i!==""&&Number(i)==i){let o=r+1;for(;++r;){let s=e.charAt(r);if(s==null||Number(s)!=s){--r;break}if(r===e.length)break}n.id=Number(e.substring(o,r+1))}if(e.charAt(++r)){let o=this.tryParse(e.substr(r));if(t.isPayloadValid(n.type,o))n.data=o;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case y.CONNECT:return Bo(r);case y.DISCONNECT:return r===void 0;case y.CONNECT_ERROR:return typeof r=="string"||Bo(r);case y.EVENT:case y.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&Dc.indexOf(r[0])===-1);case y.ACK:case y.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},Br=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let r=Lo(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function D(t,e,r){return t.on(e,r),function(){t.off(e,r)}}var Lc=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Oe=class extends S{constructor(e,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[D(e,"open",this.onopen.bind(this)),D(e,"packet",this.onpacket.bind(this)),D(e,"error",this.onerror.bind(this)),D(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){if(Lc.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;let n={type:y.EVENT,data:r};if(n.options={},n.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){let s=this.ids++,a=r.pop();this._registerAckCallback(s,a),n.id=s}let i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,r){var n;let i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=r;return}let o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);r.call(this,new Error("operation has timed out"))},i),s=(...a)=>{this.io.clearTimeoutFn(o),r.apply(this,a)};s.withError=!0,this.acks[e]=s}emitWithAck(e,...r){return new Promise((n,i)=>{let o=(s,a)=>s?i(s):n(a);o.withError=!0,r.push(o),this.emit(e,...r)})}_addToQueue(e){let r;typeof e[e.length-1]=="function"&&(r=e.pop());let n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...o)=>n!==this._queue[0]?void 0:(i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...o)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;let r=this._queue[0];r.pending&&!e||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:y.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){let n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case y.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case y.EVENT:case y.BINARY_EVENT:this.onevent(e);break;case y.ACK:case y.BINARY_ACK:this.onack(e);break;case y.DISCONNECT:this.ondisconnect();break;case y.CONNECT_ERROR:this.destroy();let n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){let r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let r=this._anyListeners.slice();for(let n of r)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){let r=this,n=!1;return function(...i){n||(n=!0,r.packet({type:y.ACK,id:e,data:i}))}}onack(e){let r=this.acks[e.id];typeof r=="function"&&(delete this.acks[e.id],r.withError&&e.data.unshift(null),r.apply(this,e.data))}onconnect(e,r){this.id=e,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:y.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let r=this._anyOutgoingListeners.slice();for(let n of r)n.apply(this,e.data)}}};function fe(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}fe.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+r:t-r}return Math.min(t,this.max)|0};fe.prototype.reset=function(){this.attempts=0};fe.prototype.setMin=function(t){this.ms=t};fe.prototype.setMax=function(t){this.max=t};fe.prototype.setJitter=function(t){this.jitter=t};var ke=class extends S{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,W(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new fe({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;let i=r.parser||qr;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new ue(this.uri,this.opts);let r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;let i=D(r,"open",function(){n.onopen(),e&&e()}),o=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},s=D(r,"error",o);if(this._timeout!==!1){let a=this._timeout,c=this.setTimeoutFn(()=>{i(),o(new Error("timeout")),r.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(D(e,"ping",this.onping.bind(this)),D(e,"data",this.ondata.bind(this)),D(e,"error",this.onerror.bind(this)),D(e,"close",this.onclose.bind(this)),D(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){le(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Oe(this,e,r),this.nsps[e]=n),n}_destroy(e){let r=Object.keys(this.nsps);for(let n of r)if(this.nsps[n].active)return;this._close()}_packet(e){let r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,r){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let r=this.backoff.duration();this._reconnecting=!0;let n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};var Xe={};function je(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};let r=Io(t,e.path||"/socket.io"),n=r.source,i=r.id,o=r.path,s=Xe[i]&&o in Xe[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||s,c;return a?c=new ke(n,e):(Xe[i]||(Xe[i]=new ke(n,e)),c=Xe[i]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Object.assign(je,{Manager:ke,Socket:Oe,io:je,connect:je});function Bc(){let t=()=>String.fromCharCode(97+Math.floor(Math.random()*26));return`${Date.now()}${t()}${t()}${t()}${t()}`}var Fr=!1,Re=class{constructor(){this.isReplay=!1;this.now=[];this.$table=$(".page--game_play .game-table");this.width=0;this.height=0;this.me=0;this.steps=[];this.players=[];this.gameEnded=!1;this.nowSelectX=-1;this.nowSelectY=-1;this.nowSelectStatus=3}endGame(){this.gameEnded=!0}updatePlayers(e){this.players=e,this.me=e.filter(r=>r.uid===O.uid)[0].id}updateMap(e){let r=e.split(";").map(o=>o.split(",")),n=Fr;if(!Fr){this.width=r[0].length,this.height=r.length;for(let o=0;o<this.height;o++)this.now.push(new Array(this.width).fill({type:"empty",owner:0,army:0}));for(let o=0;o<this.height;o++){this.$table.append(`<tr data-x="${o}"></tr>`);for(let s=0;s<this.width;s++)this.$table.find(`tr[data-x="${o}"]`).append(`<td data-x="${o}" data-y="${s}"></td>`)}$(document).on("click",".page--game_play table",o=>this.handleClickByEvent(o)),$(document).on("keydown",o=>this.handleKeydown(o)),Fr=!0}let i=[];for(let o=0;o<this.height;o++)for(let s=0;s<this.width;s++){let a=r[o][s][0],c={type:a==="g"?"general":a==="c"?"city":a==="e"?"empty":a==="m"?"mountain":a==="u"?"unknown":"obstacle",owner:+r[o][s][1],army:+r[o][s].replace(/^[a-z][0-9]/,"")};(!n||!["type","owner","army"].every(l=>this.now[o][s][l]===c[l]))&&i.push(`${o},${s}`),this.now[o][s]=c}for(let o=0;o<this.height;o++)for(let s=0;s<this.width;s++)this.updateCell(o,s),i.includes(`${o},${s}`)&&this.updateSelectStatus(o,s)}async updateCell(e,r){let n=this.now[e][r],i=this.$table.find(`td[data-x="${e}"][data-y="${r}"]`),o=(i.attr("class")||"").split(" ");if(!o.includes(`type--${n.type}`)){for(let s of o.filter(a=>a.startsWith("type--")))i.removeClass(s);i.addClass(`type--${n.type}`)}if(!o.includes(`owner--${n.owner}`)){for(let s of o.filter(a=>a.startsWith("owner--")))i.removeClass(s);i.addClass(`owner--${n.owner}`)}}async updateSelectStatus(e,r,n=!1){if(this.isReplay){let u=this.$table.find(`td[data-x="${e}"][data-y="${r}"]`),m=this.now[e][r];u.html(m.army>0||m.owner===0&&m.army===0&&m.type==="city"?m.army.toString():"");return}if(e<0||r<0||e>=this.height||r>=this.width)return;n&&await Promise.all([this.updateSelectStatus(e+1,r),this.updateSelectStatus(e-1,r),this.updateSelectStatus(e,r+1),this.updateSelectStatus(e,r-1)]);let i=this.$table.find(`td[data-x="${e}"][data-y="${r}"]`),o=this.now[e][r],a=this.nowSelectX===e&&this.nowSelectY===r&&this.nowSelectStatus===2?"50%":o.army>0||o.owner===0&&o.army===0&&o.type==="city"?o.army.toString():"";function c(u,m,v,x){return u.filter(I=>I[0][0]===e&&I[0][1]===r&&I[1][0]===e+m&&I[1][1]===r+v).length>0?x:""}i.html([c(this.steps,0,-1,'<div class="center-vertical" style="left: 0px;">\u2190</div>'),c(this.steps,0,1,'<div class="center-vertical" style="right: 0px;">\u2192</div>'),c(this.steps,-1,0,'<div class="center-horizontal" style="top: 0px;">\u2191</div>'),c(this.steps,1,0,'<div class="center-horizontal" style="bottom: 0px;">\u2193</div>'),a].join(""));let l=u=>{i.hasClass(u)&&i.removeClass(u)},f=u=>{i.hasClass(u)||i.addClass(u)},p=(u,m)=>{m?f(u):l(u)};if(this.nowSelectX===e&&this.nowSelectY===r)f("selected"),l("attackable"),f("selectable");else{let u=Math.abs(this.nowSelectX-e)+Math.abs(this.nowSelectY-r)===1;u&&=o.type!=="mountain",l("selected"),p("attackable",u),p("selectable",u||o.owner===this.me)}}handleAddStep(e,r,n,i,o){this.steps.push([[e,r],[n,i],o,Bc()]),this.updateSelectStatus(e,r),this.sendSteps()}async sendSteps(){this.socket.emit("updateSteps",this.steps)}sendSurrenderMessage(){this.socket.emit("surrender")}markStepsAsDone(e){let r=this.steps.filter(n=>e.includes(n[3]));this.steps=this.steps.filter(n=>!e.includes(n[3]));for(let n of r)this.updateSelectStatus(n[0][0],n[0][1]);this.sendSteps()}async handleClick(e,r=!0){if(this.gameEnded||this.isReplay)return;let n=this.nowSelectX,i=this.nowSelectY,o=+(e.attr("data-x")||"0"),s=+(e.attr("data-y")||"0");function a(){r||(this.nowSelectStatus=3,this.nowSelectX=this.nowSelectY=-1,this.updateSelectStatus(n,i,!0))}if(typeof e.attr("data-y")!="string")return a.bind(this)();if(e.hasClass("attackable"))this.nowSelectX=o,this.nowSelectY=s,this.handleAddStep(n,i,this.nowSelectX,this.nowSelectY,this.nowSelectStatus===2),this.nowSelectStatus=1,this.updateSelectStatus(n,i,!0),this.updateSelectStatus(o,s,!0);else if(n===o&&i===s){let c=this.nowSelectStatus===2;if(c&&!r)return a.bind(this)();this.nowSelectStatus=c?1:2,this.updateSelectStatus(n,i)}else if(e.hasClass("selectable"))console.info("select position",o,s),this.nowSelectStatus=1,this.nowSelectX=o,this.nowSelectY=s,this.updateSelectStatus(n,i,!0),this.updateSelectStatus(o,s,!0);else return a.bind(this)()}handleClickByEvent(e){this.handleClick($(e.target),!1)}handleKeydown(e){if(!(this.gameEnded||this.isReplay)&&this.nowSelectStatus!==3){if(["ArrowUp","KeyW"].includes(e.code))return this.handleClick(this.$table.find(`td[data-x="${this.nowSelectX-1}"][data-y="${this.nowSelectY}"]`));if(["ArrowDown","KeyS"].includes(e.code))return this.handleClick(this.$table.find(`td[data-x="${this.nowSelectX+1}"][data-y="${this.nowSelectY}"]`));if(["ArrowLeft","KeyA"].includes(e.code))return this.handleClick(this.$table.find(`td[data-x="${this.nowSelectX}"][data-y="${this.nowSelectY-1}"]`));if(["ArrowRight","KeyD"].includes(e.code))return this.handleClick(this.$table.find(`td[data-x="${this.nowSelectX}"][data-y="${this.nowSelectY+1}"]`));if(e.code==="KeyZ")return this.handleClick(this.$table.find(`td[data-x="${this.nowSelectX}"][data-y="${this.nowSelectY}"]`));if(e.code==="KeyQ"){let r=this.steps;this.steps=[];for(let n of r)this.updateSelectStatus(n[0][0],n[0][1]);return this.sendSteps()}if(e.code==="KeyE"){let r=this.steps.pop();return r?(this.updateSelectStatus(r[0][0],r[0][1]),r[1][0]===this.nowSelectX&&r[1][1]===this.nowSelectY&&(this.nowSelectX=r[0][0],this.nowSelectY=r[0][1],this.nowSelectStatus=1,this.updateSelectStatus(r[0][0],r[0][1],!0),this.updateSelectStatus(r[1][0],r[1][1],!0)),this.sendSteps()):void 0}if(e.code==="Escape")return this.sendSurrenderMessage()}}};var Fo=[],Dt=class{constructor(e,r,n){this.$ele=$(".alert");$("h1.alert-title").text(e),$("p.alert-description").html(r);for(let i of n)$(".alert > center").append(`<div class="button-div"><button class="${i.class}" data-key="${i.key}">${i.text}</button></div>`)}open(){return new Promise(e=>{this.$ele.removeClass("hidden"),Fo.push(r=>{let n=$(r.currentTarget);n.attr("data-key")&&(this.$ele.addClass("hidden"),this.$ele.find("div.button-div").remove(),e(n.attr("data-key")))})})}};function Uo(){$(document).on("click",".alert button",t=>{Fo.forEach(e=>e(t))})}function Lt(t){let e=32,r=30,n=30;function i(){$(".game-table-container").attr("style",[`top: ${n}px;`,`left: ${r}px;`].join(" ")),t.$table.attr("style",[`--cell-size: ${e}px;`,`--bg-size: ${e/32*25}px;`,`--number-size: ${e/32*3+9}px;`].join(" "))}function o(){$(document).on("wheel",a=>{let c=a.originalEvent.deltaY;c<0&&e<100&&(e+=6),c>0&&e>11&&(e-=6),i()})}function s(){let a=!1,c=0,l=0,f=0,p=0;$(document).on("mousedown",u=>{f=r,p=n,c=u.clientX,l=u.clientY,a=!0}),$(document).on("mouseup",u=>{a&&(a=!1,r=f+u.clientX-c,n=p+u.clientY-l,i())}),$(document).on("mousemove",u=>{a&&(r=f+u.clientX-c,n=p+u.clientY-l,i())})}o(),s(),i()}var Ce={};Hr(Ce,{update:()=>Fc});function Fc(t){$(".game-leaderboard > tbody").html(`
    <tr>
      <td><span style="white-space: nowrap;"><span style="color: gold;">\u2605 </span></span></td>
      <td>Player</td>
      <td>Army</td>
      <td>Land</td>
    </tr>
    ${t.map(e=>`
      <tr class="${e.status===3?"dead":e.status===2?"surrendered":""}">
        <td><span style="white-space: nowrap;"><span style="color: gold;">\u2605 </span>0</span></td>
        <td class="leaderboard-name owner--${e.id}">${e.name}</td>
        <td>${e.army}</td>
        <td>${e.land}</td>
      </tr>
    `).join("")}
  `)}async function Uc(){let t=+H().split("/")[2],{body:e}=await Mo.default.post("/game/info").send({token:O.token,id:t});return(e.error||![e.player1,e.player2].includes(O.uid)||e.done)&&R("/"),e}async function Ho(){let t=await Uc();console.info("game.info",t);let e=new Re,r=je(`${window.location.protocol.replace("http","ws")}//${window.location.host}`);e.socket=r;let n;r.emit("token",O.token),r.emit("join",t.gameId),r.on("error",i=>{window.alert(i),R("/")}),r.on("update",i=>{e.markStepsAsDone(i.doneSteps),e.updatePlayers(i.players),e.updateMap(i.map),Ce.update(i.players),$(".page--game_play > .turn-counter").text(Date.now()>=t.startAt?`Turn ${i.turn}${i.isHalf?".":""}`:`Game will start after ${Math.ceil((t.startAt-Date.now())/1e3)} s`),t.startAt>Date.now()?n=setInterval(()=>{$(".page--game_play > .turn-counter").text(`Game will start after ${Math.ceil((t.startAt-Date.now())/1e3)} s`)},500):clearInterval(n)}),r.on("recieveMessage",i=>{}),r.on("end",async i=>{console.info("game.end",i);let o=e.players.filter(a=>a.id===i.killBy)[0]?.name;e.endGame();let s=await new Dt(i.won?"You won!":"Game Over",i.won?"":`You were defeated by <span class="bold">${o}</span>.`,[{text:"Play Again",class:"small inverted",key:"play-again"},{text:"Watch Replay",class:"small inverted",key:"replay"},{text:"Exit",class:"inverted",key:"exit"}]).open();R("/")}),setInterval(()=>r.emit("ping"),15e3),Lt(e)}var Ur=Ie(xe());var Bt=class extends Re{constructor(r){super();this.replay=r;this.isReplay=!0;this.nowTurn=1;this.isHalf=!1;this.updateMap(this.replay.initial.join(";")),this.updateLeaderboard()}gotoTurn(r,n){let i=this.nowTurn*2+(this.isHalf?1:0)-3,o=r*2+(n?1:0)-3;if(!(o<-1||o>=this.replay.turns.length||Math.floor(o)!==o)){if($(".page--game_play > .turn-counter").text(`Turn ${r}${n?".":""}`),i<o)for(let a=i+1;a<=o;a++){let c=this.replay.turns[a].split(",");for(let l of c)l&&this.updateDiffMap(l)}else{this.updateMap(this.replay.initial.join(";"));for(let a=0;a<=o;a++){let c=this.replay.turns[a].split(",");for(let l of c)l&&this.updateDiffMap(l)}}this.updateLeaderboard(),this.nowTurn=r,this.isHalf=n}}updateLeaderboard(){let r={},n={};for(let o=0;o<this.now.length;o++)for(let s=0;s<this.now[0].length;s++){let{owner:a,army:c}=this.now[o][s];n[a]=(n[a]||0)+1,r[a]=(r[a]||0)+c}let i=Object.entries(this.replay.idToPlayer).map(([o,s])=>({id:+o,uid:s,name:s.toString(),army:r[+o]||0,land:n[+o]||0,status:(n[+o]||0)===0?3:1})).sort((o,s)=>o.army===s.army?s.land-o.land:s.army-o.army);Ce.update(i)}updateDiffMap(r){let n=+r.replace(/[a-z]\d+/,""),i=Math.floor(n/this.now[0].length),o=n%this.now[0].length,s=r.replace(/\d/g,"");this.now[i][o].type=s==="g"?"general":s==="c"?"city":s==="e"?"empty":"mountain";let a=r.replace(/\d+[a-z]/,"");this.now[i][o].owner=+a[0],this.now[i][o].army=+a.slice(1),this.updateCell(i,o),this.updateSelectStatus(i,o)}};async function Hc(){if(window.site_prefix!==""){let r=(window.location.search.split("?id=")[1]||"").split("&")[0];try{let{body:n}=await Ur.default.get(`/generals-replays/replays/${r}.json`);return n}catch(n){return console.error(n),window.alert("\u627E\u4E0D\u5230\u8BE5\u56DE\u653E\u3002"),R("/")}}let t=+H().split("/")[2],{body:e}=await Ur.default.post("/game/replay").send({token:O.token,id:t});return e.error&&R("/"),e.replay}async function Wo(){let t=await Hc();console.info("game.replay",t);let e=new Bt(t);setInterval(()=>{e.isHalf?e.gotoTurn(e.nowTurn+1,!1):e.gotoTurn(e.nowTurn,!0)},500),Lt(e)}var Go={};function Ze(t,e){Go[t]={page:t,init:e},console.info(`Registered page ${t}`)}var Qe="";function et(t){console.info(`Going to page ${t}`),Qe&&$(`.page.page--${Qe}`).removeClass("active"),Qe=t,Go[Qe].init(),$(`.page.page--${Qe}`).addClass("active")}Ze("home",io);Ze("login",oo);Ze("game_play",Ho);Ze("game_replay",Wo);$(async()=>{Uo(),window.site_prefix===""&&await O.init();let t=H();/^\/login$/.test(t)?et("login"):/^\/$/.test(t)?et("home"):/^\/game\/[1-9][0-9]*?\/play$/.test(t)?et("game_play"):/^\/game\/[1-9][0-9]*?\/replay$/.test(t)||window.site_prefix!==""?et("game_replay"):R("/")});})();
